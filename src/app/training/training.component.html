<app-session-warning *ngIf="connectionError"></app-session-warning>
<app-session *ngIf="state === states.INTRO"
  [session]="currentSession"
  [sessions]="indicatorSessions"
  [sessionIndex]="sessionIndex"
  (finalPageCount)="stepPageCount($event)"
  (done)="sessionComplete()"
  (showIndicator)="true"
></app-session>
<app-session *ngIf="state === states.READINESS"
             [session]="readinessRulers[0]"
             [sessions]="readinessRulers"
             [sessionIndex]="0"
             (finalPageCount)="1"
             (done)="readinessComplete()"
             (showIndicator)="false"
></app-session>
<div *ngIf="state === states.TRAINING">
  <mat-card class="training">
    <mat-card-content>
        <div class="round-header">Round {{roundIndex+ 1}} of {{totalRounds}}</div>
        <div class="progress">
          <app-progress-bar [items]="round.scenarios"></app-progress-bar>
        </div>
        <app-scenario
          *ngIf="round.scenario"
          [scenario]="round.scenario"
          [scenarioIndex]="scenarioIndex"
          [session]="currentSession"
          [sessionIndex]="sessionIndex"
          [pageCount]="pageCount"
          (finalCount)="updatePageCount($event)"
          (done)="nextTraining($event)"
        ></app-scenario>
    </mat-card-content>
  </mat-card>
</div>
<div *ngIf="state === states.SUMMARY">
  <mat-card class="training">
    <mat-card-content>
      <img class="summaryImage" src="./assets/lemon.png"/>
      <div class="summary">
        <div class="text">
          <p class="em">Round {{roundIndex+1}} complete!</p>
          <p>You finished with a {{round.percentCorrect() | percent}} accuracy rating.</p>
          <p> Excellent work. Keep it up!</p>
        </div>
        <div class="spacer"></div>
        <button *ngIf="!isComplete()" class="continue"  mat-raised-button (click)="nextRound()">Start Round {{roundIndex+2}}</button>
        <button *ngIf="isComplete()" class="continue"  mat-raised-button (click)="close()">Continue</button>
      </div>
    </mat-card-content>
  </mat-card>
</div>

